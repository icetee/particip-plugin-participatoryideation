<#include "ideation_search_solr_search_results.html">

    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
        <div id="resultItems" class="row resultats-recherche project_list_container">
            <div class="solr-paginator">
                <@paginationSolr paginator=paginator />      
            </div>
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 search_item_count" style="text-align:right; padding-right:15px;">
                #i18n{portal.search.search_results.labelResultsCount} : <strong>${paginator.itemsCount}</strong>
                - #i18n{portal.search.search_results.labelResultsRange} : <strong>${paginator.rangeMin} - ${paginator.rangeMax}</strong>
            </div>

            <#list results_list as result>
            <#assign theme_class = "autre">
            <#if result.dynamicFields?? && result.dynamicFields.code_theme_string??>
            <#if result.dynamicFields.code_theme_string = "CADRE"><#assign theme_class = "cadre_vie">
            <#elseif result.dynamicFields.code_theme_string = "CULTURE"><#assign theme_class = "culture">
            <#elseif result.dynamicFields.code_theme_string = "ECO"><#assign theme_class = "economie_emploi">
            <#elseif result.dynamicFields.code_theme_string = "EDU"><#assign theme_class = "education">
            <#elseif result.dynamicFields.code_theme_string = "ENVIRONNEMENT" || result.dynamicFields.code_theme_string = "NAT"><#assign theme_class = "environnement">
            <#elseif result.dynamicFields.code_theme_string = "LOGEMENT"><#assign theme_class = "logement">
            <#elseif result.dynamicFields.code_theme_string = "PARTICIPATION"><#assign theme_class = "participation_citoyenne">
            <#elseif result.dynamicFields.code_theme_string = "SECURITE"><#assign theme_class = "prevention_securite">
            <#elseif result.dynamicFields.code_theme_string = "PROPRETE"><#assign theme_class = "proprete">
            <#elseif result.dynamicFields.code_theme_string = "SOLIDARITE" || result.dynamicFields.code_theme_string = "VIVREENSEMBLE"><#assign theme_class = "solidarite">
            <#elseif result.dynamicFields.code_theme_string = "SPORT"><#assign theme_class = "sport">
            <#elseif result.dynamicFields.code_theme_string = "TRANSPORT"><#assign theme_class = "transport">
            <#elseif result.dynamicFields.code_theme_string = "NUM"><#assign theme_class = "ville_numerique">
            </#if>
            </#if>

            <#if (result.dynamicFields.code_theme_string)??>
            <#assign theme_libelle = (campagne_static.themes_map[result.dynamicFields.code_theme_string].title)!result.dynamicFields.code_theme_string>
            </#if>
                        
            <div class="item" style="margin:10px;"> 
                <div id="right-item" class="col-xs-12 col-sm-3 col-md-3 col-lg-3" style="padding:10px;">
                    <div class="row projectlist_project">
                        <div class="project_ref project_${theme_class}">
                            <#if result.dynamicFields?? && result.dynamicFields.pseudo_string??>
                                projet de ${result.dynamicFields.pseudo_string!}
                            <#else>PROJET A CORRIGER
                            </#if>
                        </div>
                        <div class="project_category col-xs-12 hidden-sm hidden-md hidden-lg
                            <#if result.dynamicFields?? && result.dynamicFields.code_theme_string??>
                                ${theme_class}"><img src="images/local/skin/i_${theme_class}.png" alt="${theme_libelle}" title="${theme_libelle}">
                        
                            ${theme_libelle}
                            <#else>
                                <#assign theme_class = "notheme">
                                ${theme_class}">
                                <img src="images/local/skin/i_notheme.png">
                                PAS DE THEMATIQUE
                            </#if>
                        </div>
                        <div class="project_category hidden-xs col-sm-12 hidden-md hidden-lg 
                            <#if result.dynamicFields?? && result.dynamicFields.code_theme_string??>
                                ${theme_class}"><img src="images/local/skin/i_${theme_class}.png" alt="${theme_libelle}" title="${theme_libelle}">
                        
                            <#if theme_libelle?length &gt; 12>${theme_libelle?substring(0,10)}...<#else>${theme_libelle}</#if>
                            <#else>
                                <#assign theme_class = "notheme">
                                ${theme_class}">
                                <img src="images/local/skin/i_notheme.png">
                                PAS DE THEMATIQUE
                            </#if>
                        </div>
                        <div class="project_category hidden-xs hidden-sm col-md-12 hidden-lg 
                            <#if result.dynamicFields?? && result.dynamicFields.code_theme_string??>
                                ${theme_class}"><img src="images/local/skin/i_${theme_class}.png" alt="${theme_libelle}" title="${theme_libelle}">
                        
                            <#if theme_libelle?length &gt; 16>${theme_libelle?substring(0,16)}...<#else>${theme_libelle}</#if>
                            <#else>
                                <#assign theme_class = "notheme">
                                ${theme_class}">
                                <img src="images/local/skin/i_notheme.png">
                                PAS DE THEMATIQUE
                            </#if>
                        </div>
                        <div class="project_category hidden-xs hidden-sm hidden-md col-lg-12 
                            <#if result.dynamicFields?? && result.dynamicFields.code_theme_string??>
                                ${theme_class}"><img src="images/local/skin/i_${theme_class}.png" alt="${theme_libelle}" title="${theme_libelle}">
                        
                            <#if theme_libelle?length &gt; 24>${theme_libelle?substring(0,24)}...<#else>${theme_libelle}</#if>
                            <#else>
                                <#assign theme_class = "notheme">
                                ${theme_class}">
                                <img src="images/local/skin/i_notheme.png">
                                PAS DE THEMATIQUE
                            </#if>
                        </div>
                        
                        <div class="project_title col-xs-12 hidden-sm hidden-md hidden-lg">
                            <a href="${result.url}" alt="${result.title}" title="${result.title}">
                                ${result.title}
                            </a>
                        </div>
                        <div class="project_title hidden-xs col-sm-12 hidden-md hidden-lg">
                            <a href="${result.url}" alt="${result.title}" title="${result.title}">
                                <#if result.title?length &gt; 45>${result.title?substring(0,45)}...<#else>${result.title}</#if>
                            </a>
                        </div>
                        <div class="project_title hidden-xs hidden-sm col-md-12 hidden-lg">
                            <a href="${result.url}" alt="${result.title}" title="${result.title}">
                                <#if result.title?length &gt; 40>${result.title?substring(0,40)}...<#else>${result.title}</#if>
                            </a>
                        </div>
                        <div class="project_title hidden-xs hidden-sm hidden-md col-lg-12">
                            <a href="${result.url}" alt="${result.title}" title="${result.title}">
                                <#if result.title?length &gt; 65>${result.title?substring(0,65)}...<#else>${result.title}</#if>
                            </a>
                        </div>
                        <div>
                            <div class="row">
                                <div class="col-xs-8" style="height:70px">
                                    <span class="project_location">
                                        <img src="images/local/skin/projet_localisation.png" width="25px" height="25px" alt="Localisation" title="Localisation">
                                        <#if result.dynamicFields?? && result.dynamicFields.localisation_text??>
                                            <#if result.dynamicFields.localisation_text = "Tout Paris">
                                                ${result.dynamicFields.localisation_text}
                                            <#elseif result.dynamicFields.localisation_text?length &gt; 45>${result.dynamicFields.localisation_text?substring(0,45)?html}<#else>${result.dynamicFields.localisation_text?html}</#if>
                                        </#if>
                                    </span>
                                </div>
                                <div class="col-xs-4" style="height:70px">
                                    <span class="project_budget">
                                        <#if result.dynamicFields?? && result.dynamicFields.budget_long?? && result.dynamicFields.budget_long &gt; 0>
                                        <#setting locale="fr_FR">
                                        ${result.dynamicFields.budget_long?string("#,###")} &#8364;
                                        <#else>-
                                        </#if>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="project_description col-xs-12 col-sm-12 col-md-12 col-lg-12">
                            <#if result.summary?has_content>
                                <#if result.summary?length &gt; 200>${result.summary?substring(0,200)}...<#else>${result.summary}</#if>
                            </#if>  
                        </div>
                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" id="lien-detail">
                              <!--  <a href="${result.url}">
                                Fiche Projet
                                     </a>
                                -->
                             <#assign id_document = "${(result.id?split('null_')?last)?split('_')?first}">
                            <!--  @Extender[${id_document},document,vote,{show:"all"}]@ -->
                             <!--
                            <input type="hidden" name="localisation_${id_document}" id="localisation_${id_document}" value="${result.dynamicFields.localisation_text}" />
                            <input type="hidden" name="title_${id_document}" id="title_${id_document}" value="${result.title}" />
                            <input type="hidden" name="thematique_${id_document}" id="thematique_${id_document}" value="${result.dynamicFields.code_theme_string}" />
    -->
                        </div>
                    </div> 
                </div> 
            </div>
        </#list>
        <div class="clearfix">&#160;</div>
        <div class="solr-paginator">
            <@paginationSolr paginator=paginator />      
        </div>
    </div>
</div>

<#-- Freemarker macros -->

<#-- Number of items per page selector - Combo Box implementation -->
<#macro NbItemsPerPageSelectorCombo nb_items_per_page>
    <select name="items_per_page">
        <#list [ "10" , "20" , "50" , "100" ] as nb>
            <#if nb_items_per_page = nb >
                <option selected="selected" value="${nb}">${nb}</option>
            <#else>
                <option value="${nb}">${nb}</option>
            </#if>
        </#list>
    </select>
</#macro>

<#-- Number of items per page selector - Radio List implementation -->
<#macro NbItemsPerPageSelectorRadioList nb_items_per_page>
    <#list [ 5 , 10 , 20 , 50 ] as nb>
    <#if nb = nb_items_per_page > 
    <input value="${nb}" id="items_per_page${nb}" name="items_per_page" class="radio" type="radio" checked /><label for="items_per_page${nb}">${nb}</label>
    <#else>
    <input value="${nb}" id="items_per_page${nb}" name="items_per_page" class="radio" type="radio" /><label for="items_per_page${nb}">${nb}</label>
    </#if>
    </#list>
</#macro>

<#macro paginationSolr paginator >
    <#assign nbLinkPages = 3 />
    <#assign offsetPrev = nbLinkPages/2 />
    <#assign offsetNext = nbLinkPages/2 />
    
    <#if paginator.pageCurrent &lt; nbLinkPages-offsetPrev>
        <#assign offsetPrev = nbLinkPages - paginator.pageCurrent />
        <#assign offsetNext = nbLinkPages - offsetPrev />
    <#elseif paginator.pageCurrent &gt; paginator.pagesCount - (nbLinkPages - offsetNext) >
        <#assign offsetNext = nbLinkPages - (paginator.pagesCount - paginator.pageCurrent) />
        <#assign offsetPrev = nbLinkPages - offsetNext />
    </#if>

    <#if (paginator.pagesCount > 1) >
        <#if paginator.pageCurrent &gt; nbLinkPages-offsetPrev >
          <a href="${paginator.firstPageLink?xhtml}${monTri}" alt="Première page" title="Première page"><i class="fa fa-fast-backward"></i></a>
        </#if>
        <#if (paginator.pageCurrent > 1) >
           <a href="${paginator.previousPageLink?xhtml}${monTri}" alt="Page précédente" title="Page précédente"><i class="fa fa-step-backward"></i></a>
        </#if>
        <#if paginator.pageCurrent &gt; nbLinkPages-offsetPrev >
           <span>...</span>
        </#if>
        <#list paginator.pagesLinks as link>
            <#if ( link.index == paginator.pageCurrent )>
                <span class="paginator-current-page">${link.name}</span> |
            <#else>
                <a href="${link.url?xhtml}${monTri}">${link.name}</a> |
            </#if>
        </#list>
        <#if paginator.pageCurrent &lt; paginator.pagesCount - (nbLinkPages-offsetNext) >
            <span>...</span>
        </#if>
        <#if (paginator.pageCurrent < paginator.pagesCount) > 
            <a href="${paginator.nextPageLink?xhtml}${monTri}" alt="Page suivante" title="Page suivante"><i class="fa fa-step-forward"></i></a>
            <#if paginator.pageCurrent &lt; paginator.pagesCount - (nbLinkPages-offsetNext) >
                  <a href="${paginator.lastPageLink?xhtml}${monTri}" alt="Dernière page" title="Dernière page"><i class="fa fa-fast-forward"></i></a>
            </#if>
        </#if>
        </ul>
    </#if>
</#macro>
<#assign arr_arrond=" " />
<#if arr == "Tout Paris">
     <#assign   arr_arrond = "tout_paris_text" />
<#elseif arr == "all_arr"  || arr == "" />
    <#assign   arr_arrond = "type" />
<#else>
    <#assign   arr_arrond="arrondissement_"+(arr?split('e ')?first)+"_text" />
</#if>
